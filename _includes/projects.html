<section class="projects">
  <h2>Mis Proyectos</h2>
  
  <!-- Mostrará el estado de las pruebas -->
  <div id="test-results" style="margin: 20px 0; padding: 15px; border: 1px solid #ddd;"></div>
  
  <div id="projects-container">
    <!-- Proyectos se cargarán aquí -->
  </div>
</section>

<script src="{{ '/assets/js/orm.js' | relative_url }}"></script>
<script>
document.addEventListener('DOMContentLoaded', async function() {
  // Ruta relativa que funciona en local y GitHub Pages
  const dataPath = window.location.host.includes('github.io')
    ? `/${window.location.pathname.split('/')[1]}/_data/projects.json`
    : '/_data/projects.json';
  
  const orm = new ORM(dataPath);
  
  try {
    const projects = await orm.getAll();
    const container = document.getElementById('projects-container');
    
    projects.forEach(project => {
      const projectEl = document.createElement('div');
      projectEl.className = 'project';
      projectEl.innerHTML = `
        <h3>${project.title}</h3>
        <p>${project.description}</p>
        ${project.url ? `<a href="${project.url}" target="_blank">Ver proyecto</a>` : ''}
      `;
      container.appendChild(projectEl);
    });
    
    // Muestra éxito en pruebas
    document.getElementById('test-results').innerHTML = 
      '<div style="color:green;">✅ ORM funcionando correctamente</div>';
    
  } catch (error) {
    document.getElementById('test-results').innerHTML = 
      `<div style="color:red;">❌ Error en ORM: ${error.message}</div>`;
    console.error('Error:', error);
  }
});
</script>
